<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Device Info Gatherer</title>
</head>
<body>
  <h1>Welcome to my website!</h1>
  <h2>Device Information:</h2>
  <p id="info">Loading...</p> <!-- This is where the info will be printed -->

  <script>
    // Declare global variables
    var deviceType, browser, country = "Unknown Country", ip = "Unknown IP";

    // Function to gather the necessary info
    function getDeviceInfo() {
      var userAgent = navigator.userAgent || navigator.vendor || window.opera;
      deviceType = /Mobi|Tablet|iPad|iPhone|Android/.test(userAgent) ? 'Mobile' : 'Desktop';

      // Improved browser detection
      browser = (function () {
        if (userAgent.match(/Opera|OPR/)) return "Opera";
        if (userAgent.match(/Chrome/)) return "Chrome";
        if (userAgent.match(/Safari/) && !userAgent.match(/Chrome/)) return "Safari";
        if (userAgent.match(/Firefox/)) return "Firefox";
        if (userAgent.match(/Edge/)) return "Edge";
        return "Unknown Browser";
      })();
    }

    // Function to get IP and country info
    function getIpAndCountryInfo() {
      // First, gather device info
      getDeviceInfo();

      // Fetch IP and country from ipapi.co (securely)
      fetch('https://ipapi.co/json/')
        .then(response => response.json())
        .then(data => {
          ip = data.ip || "Unknown IP";
          country = data.country_name || "Unknown Country";

          // Print the info on the page
          document.getElementById("info").innerText = 
            `Device Type: ${deviceType}\n` +
            `Browser: ${browser}\n` +
            `Country: ${country}\n` +
            `IP Address: ${ip}\n`;
        })
        .catch(error => {
          console.error('Error fetching IP or country:', error);
          document.getElementById("info").innerText = 
            `Device Type: ${deviceType}\n` +
            `Browser: ${browser}\n` +
            `Country: Could not be fetched\n` +
            `IP Address: Could not be fetched`;
        });
    }

    // Run on page load
    window.onload = getIpAndCountryInfo;
  </script>
</body>
</html>
